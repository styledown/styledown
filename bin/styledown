#!/usr/bin/env node
var Styledown = require('..'),
    read = require('read-input');

var args = require('minimist')(process.argv.slice(2), {
  boolean: ['inline', 'css', 'js', 'conf'],
  alias: { h: 'help', v: 'version', i: 'inline' }
});

if (args.help) {
  console.log([
      'Usage:',
      '    styledown [options] FILE',
      '    ... | styledown [options]',
      '    styledown --css > styledown.css',
      '',
      'Options:',
      '    -h, --help         print usage information',
      '    -v, --version      show version info and exit',
      '    -i, --inline       force extracts from inline CSS comments (for piping)',
      '',
      'Printing default files:',
      '        --conf         prints the default configuration file',
      '        --css          prints the default CSS',
      '        --js           prints the default JS',
  ].join('\n'));
  process.exit();
}

if (args.version) {
  console.log(require('../package.json').version);
  process.exit();
}

if (args.js) {
  process.stdout.write(Styledown.defaults.js());
  process.exit();
}

if (args.css) {
  process.stdout.write(Styledown.defaults.css());
  process.exit();
}

if (args.conf) {
  process.stdout.write(Styledown.defaults.conf());
  process.exit();
}

read(args._, function (err, res) {
  var html = Styledown.parse(res.files, {
    inline: args.inline
  });
  process.stdout.write(html + "\n");
});
